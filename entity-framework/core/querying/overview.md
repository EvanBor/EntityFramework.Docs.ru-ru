---
title: "Каким образом запросы трудозатраты - EF Core"
author: rowanmiller
ms.author: divega
ms.date: 10/27/2016
ms.assetid: de2e34cd-659b-4cab-b5ed-7a979c6bf120
ms.technology: entity-framework-core
uid: core/querying/overview
ms.openlocfilehash: 7fd2940d559f82016d7a8fc3fdcf3af0d5b8bc8f
ms.sourcegitcommit: 01a75cd483c1943ddd6f82af971f07abde20912e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2017
---
# <a name="how-queries-work"></a>Как работают запросы

Entity Framework Core использует интегрировать запросы языка (LINQ) для запроса данных из базы данных. LINQ позволяет использовать C# (или выбранный язык .NET) для записи строго типизированные запросы, основанные на производных классах, контекст и сущности.

## <a name="the-life-of-a-query"></a>Срока действия запроса

Ниже приведен общий обзор процесса, который проходит каждого запроса.

1. Запрос LINQ, обрабатывается Entity Framework Core для построения в представление, готов к обработке поставщиком базы данных
   1. Результат в кэш, чтобы эта обработка не требуется выполнять при каждом выполнении запроса
2. Результат передается поставщику базы данных
   1. Поставщик баз данных определяет, какие части запроса может вычисляться в базе данных
   2. Эти части запроса преобразуются в язык запроса базы данных (например SQL для реляционной базы данных)
   3. Один или несколько запросы отправляются в базу данных и результирующий набор (результатов являются значениями из базы данных, не экземпляров сущностей)
3. Для каждого элемента в результирующем наборе
   1. Если это запрос отслеживания EF проверяет, если данные представляют сущности уже в объекте отслеживания изменений для экземпляра контекста
      * В этом случае возвращается существующей сущности
      * В противном случае создается новая сущность, отслеживание изменений, установки и возвращается новая сущность
   2. Если это запрос нет отслеживания EF проверяет, если данных представляет собой сущность, уже в результирующем наборе для этого запроса
      * Если Да, возвращается существующей сущности <sup>(1)</sup>
      * В противном случае создается и возвращается новая сущность

<sup>(1) </sup> Отсутствуют запросы отслеживания использования слабых ссылок для отслеживания объектов, которые уже были возвращены. Если предыдущий результат с тем же удостоверением выходит за пределы области, а сборка мусора выполняется, может получить новый экземпляр сущности.

## <a name="when-queries-are-executed"></a>При выполнении запросов

При вызове операторы LINQ, вы просто строите в памяти представление запроса. Запрос отправляется в базу данных только после обработки результатов.

Ниже приведены наиболее распространенных операций, которые приводят в запросе, отправляемых в базе данных.
* Итерация результаты в `for` цикла
* С помощью оператора, например `ToList`, `ToArray`, `Single`,`Count`
* Привязка данных результаты запроса к пользовательскому Интерфейсу

> [!WARNING]  
> **Всегда проверять вводимые:** пока EF обеспечивают защиту от атак путем внедрения кода SQL, он не включает общие проверку входных данных. Поэтому если значения, передаваемые в API-интерфейсы, используемые в запросах LINQ, назначенные свойства сущности, т. д., берутся из ненадежного источника, а затем соответствующую проверку, в соответствии с требованиями вашего приложения, необходимо выполнить. Сюда входят вводимых пользователем, используемый для динамического построения запросов. Даже при использовании LINQ, если вы принимаете ввода данных пользователя, для построения выражений, необходимые для убедитесь в том, чем только нужные выражения может быть создан.
